# -*- encoding: utf-8 -*-
#class for obtain metadata info from images

import os
import pygeoip
import pprint
#geolocation lib

try:
    from pygeocoder import Geocoder
except Exception as e:
    print("pip install pygeocoder")
    exit(1)
    
    
class InfoLocation:

    def geoInfo(self,hostName,ip):
		print '\nGeoLocation Info'
		print "--------------------------"
		print hostName
		print ip
		try:
			#Informacion geolocalizaci√≥n
			gi = pygeoip.GeoIP('GeoLiteCity.dat')
			pprint.pprint("Country code: %s " %(str(gi.country_code_by_name(hostName))) )
			pprint.pprint("Full record: %s " %(str(gi.record_by_addr(ip))) )
			pprint.pprint("City: %s " %((gi.record_by_addr(ip)['city']).decode('utf-8') ))
			pprint.pprint("Timezone: %s " %(str(gi.record_by_addr(ip)['time_zone'])) )
			pprint.pprint("Country name: %s " %(str(gi.country_name_by_addr(ip))) )
			pprint.pprint("Timezone: %s" %(str(gi.time_zone_by_addr(ip))) )
			pprint.pprint("Continent: %s " %(str(gi.record_by_addr(ip)['continent'])) )
         
			print '\nGeoLocation Latitude'
			print "--------------------------"
			print gi.record_by_addr(ip)['latitude']
    
			print '\nGeoLocation Longitude'
			print "--------------------------"
			print gi.record_by_addr(ip)['longitude']
    
			latitude = gi.record_by_addr(ip)['latitude']
			longitude = gi.record_by_addr(ip)['longitude']
    
			print '\nAddress'
			print "--------------------------"
    
			results = Geocoder.reverse_geocode(latitude, longitude)
			pprint.pprint(results.formatted_address)
    
		except Exception as e:
                        print str(e)
			print "Error obtaining geolocation"
			pass
