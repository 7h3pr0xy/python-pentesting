# -*- encoding: utf-8 -*-
#class for search in shodan
import shodan

class ShodanSearch:

    def __init__(self):
        #shodan key
        shodanKeyString = 'v4YpsPUJ3wjDxEqywwu6aF5OZKWj8kik'
        self.shodanApi = shodan.Shodan(shodanKeyString)
        
    def shodanKeyInfo(self):
        try:
            info = self.shodanApi.info()
            for inf in info:
                print '%s: %s ' %(inf, info[inf])
        except Exception, e:
            print 'Error: %s' % e
            

    #Obtain info IP
    def obtain_host_info(self,IP):
        try:
                host = self.shodanApi.host(IP)
                if len(host) != 0:
                            # Print host info
                            print 'IP: %s' % host.get('ip_str')
                            print 'Country: %s' % host.get('country_name','Unknown')
                            print 'City: %s' % host.get('city','Unknown')
                            print 'Latitude: %s' % host.get('latitude')
                            print 'Longitude: %s' % host.get('longitude')
                            print 'Hostnames: %s' % host.get('hostnames')
                            for i in host['data']:
                               print 'Port: %s' % i['port']
                               
                            return host
        except shodan.APIError, e:
                print ' Error obtaning info from Shodan Service: %s' % e